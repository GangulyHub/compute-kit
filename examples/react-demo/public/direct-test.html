<!doctype html>
<html>
  <head>
    <title>ComputeKit Direct Test</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 20px;
        background: #1a1a2e;
        color: #eee;
      }
      .output {
        background: #16213e;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
        white-space: pre-wrap;
        font-family: monospace;
        max-height: 400px;
        overflow-y: auto;
      }
      button {
        background: #0f3460;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        margin: 5px;
      }
      button:hover {
        background: #1a508b;
      }
      h1 {
        color: #e94560;
      }
    </style>
  </head>
  <body>
    <h1>ComputeKit Direct Test</h1>
    <p>Open browser DevTools (F12) to see console logs.</p>

    <div>
      <button id="btnTest">Run Test</button>
    </div>

    <h3>Output:</h3>
    <div id="output" class="output">Click "Run Test" to begin...</div>

    <script type="module">
      import { ComputeKit } from '/@fs/c:/dev/compute-kit/packages/core/dist/index.js';

      const output = document.getElementById('output');
      const btnTest = document.getElementById('btnTest');

      function log(msg) {
        const timestamp = new Date().toISOString().split('T')[1].slice(0, 12);
        const line = `[${timestamp}] ${msg}`;
        console.log(line);
        output.textContent += line + '\n';
        output.scrollTop = output.scrollHeight;
      }

      async function runTest() {
        output.textContent = '';
        log('Creating ComputeKit instance...');

        const kit = new ComputeKit({ debug: true, timeout: 10000 });

        log('Registering functions...');
        kit.register('double', (n) => n * 2);
        kit.register('add', (a, b) => a + b);

        log('Functions registered. Calling kit.run("double", 21)...');

        try {
          const result = await kit.run('double', 21);
          log(`SUCCESS! Result: ${result}`);
        } catch (err) {
          log(`ERROR: ${err.message}`);
          log(err.stack);
        }

        log('Test complete. Terminating...');
        await kit.terminate();
        log('Done.');
      }

      btnTest.addEventListener('click', runTest);

      // Auto-run on load
      log('Page loaded. Running test in 1 second...');
      setTimeout(runTest, 1000);
    </script>
  </body>
</html>
